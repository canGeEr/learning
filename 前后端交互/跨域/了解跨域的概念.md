# 跨域
> 因为浏览器出于安全考虑，有同源策略。也就是说，如果协议、域名或者端口有一个不同就是跨域，Ajax 请求会失败

> **浏览器**限制**XMLHttpRequest**、**fetch**在非同源的情况下，而img、script或者link等等默认都不会有跨域限制

## 为什么需要跨域限制
- 其实主要是用来防止 CSRF 攻击的。简单点说，CSRF 攻击是利用用户的登录态发起恶意请求
- 第三方访问该网站数据，可以盗用用户身份信息，用户隐私数据

## 同源和站点
- 同源：协议、域名或者端口        
- 同站点：**域名相同**    

## 浏览器怎么去判断是否跨域
> 简单请求和非简单请求，核心点就是请求“大”考虑发出是不是无效浪费

- 服务器再请求投写入origin字段为当前域名
- 简单请求，浏览器先直接发出请求，再判断是否跨域
- 复杂请求，浏览器先发出预检请求，判断是否允许跨域，再判断是否发出（响应报文的Access-Control-Allow-Origin、Access-Control-Allow-Credentials）

### 如何区别复杂和简单请求
- 请求方法是HEAD，GET，POST之一
- HTTP请求
    - 头信息不超出以下几种字段（没有自定义的头部）：Accept、Accept-Language、Content-Language、Last-Event-ID、
    - Content-Type：只限于三个值application/x-www-form-urlencoded、multipart/form-data、text/plain

### 复杂请求怎么做的：
option预检请求 浏览器先询问服务器，当前网页所在的域名是否在服务器的许可名单之中，以及可以使用哪些HTTP动词和头信息字段。只有得到肯定答复，浏览器才会发出正式的XMLHttpRequest请求，否则就报错（是否允许跨域）