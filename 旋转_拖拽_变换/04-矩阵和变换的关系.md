# 04-矩阵和变换的关系

## css Transform属性的matrix（只考虑2d）
matrix(a, b, c, d, e, f)

在笛卡尔坐标系R^3里表示
```javascript
a  c  e     x
b  d  f  *  y
0  0  1     1

=> 
ax + cy + e
by + dy + f
1
```

将点x，y和变换矩阵运算得到的新的点就是变换的结果点，如果是图形需要变换呢？，那么图形的所有点和变换矩阵进行运算，得到的每个点围成的图形就是目标图形

## matrix 和 translate、rotate、、scale、skew的关系


## translate
translate就是位移，如果一个点坐标是(x, y)，translate(tx, ty)，得到的坐标就是(x + tx, y + ty)，对应需要的变换矩阵：
```javascript
1  0  tx     x
0  1  ty  *  y
0  0  1      1

=>
x + tx
y + ty
1
```
所以，用matrix表示translate(tx, ty)是matrix(1, 0, 0, 1, tx, ty)


## scale
scale表示缩放，如果一个点的坐标是(x, y)，scale(a, b)，得到的坐标是(a * x, b * y)，对应需要的变换矩阵是：
```javascript
a  0  0     x
0  b  0  *  y
0  0  1     1

=>
a * x 
b + y
1
```
用matrix表示缩放：matrix(a, 0, 0, b, 0, 0)

## rotate
rotate表示旋转，如果一个点的坐标是(x, y)，rotate(\$deg)，得到的坐标是(cos(\$) * x - sin(\$) * y, cos(\$) * x + sin($) * y)，对应的需要的变换矩阵就是：
```javascript
cos($)  -sin($)  0     x
sin($)   cos($)  0  *  y
0        0       1     1

=>
cos($) * x - sin($) * y
sin($) * x + cos($) * y
1

(这里 $ 需要转换 => $ / 180 * Math.PI)
```
用matrix表示旋转：matrix(cos(\$), cos(\$), -sin(\$), sin(\$), 0, 0)

## skew
rotate表示倾斜，如果一个点的坐标是(x, y)，skew(\$1, \$2)，对应的需要的变换矩阵就是：
```javascript
1         tan($1)   0     x
tan($2)   1         0  *  y
0         0         1     1

=>
x + tan($1) * y
tan($2) * x + y
1
```

## transform

- C * (A * B) = (A * C) * B （矩阵叉乘符合交换律），把B想象成点，A和C当成matrix矩阵，点B选经过变换A，再变换C,等同经过 A * C 的变换矩阵 

- A * A(-1) = E，E 叉乘 点坐标 不会发生变换，因此如果A是rotate($)的matrix，那么A(-1)就是把点逆时针旋$deg
```javascript
1  0  0
0  1  0
0  0  1
```


transform函数就是在做matrix这种运算，可以理解为：

```javascript
function transform(matrixList, pointMatrix) {
  const transformMatrix = matrixList.reduce((prevResult, matrix) => {
    return multiply(prevResult, matrix)
  }, pointMatrix) 
  return transformMatrix
}
```


